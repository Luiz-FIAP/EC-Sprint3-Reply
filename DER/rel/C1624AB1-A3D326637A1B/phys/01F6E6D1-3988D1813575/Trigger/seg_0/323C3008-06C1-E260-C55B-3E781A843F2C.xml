<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="trg_update_device_last_seen" directorySegmentName="seg_0" id="323C3008-06C1-E260-C55B-3E781A843F2C">
<sourceDDLFile>initial_data.sql</sourceDDLFile>
<createdBy>luizh</createdBy>
<createdTime>2025-09-06 15:37:24 UTC</createdTime>
<ownerDesignName>DER</ownerDesignName>
<actions>INSERT</actions>
<body><![CDATA[DECLARE
    v_device_id VARCHAR2(50);
BEGIN
    -- Encontra o device_id atravÃ©s do sensor_id
    SELECT device_id INTO v_device_id
    FROM sensors 
    WHERE sensor_id = :NEW.sensor_id;
    
    -- Atualiza o last_seen do dispositivo
    UPDATE devices 
    SET last_seen = :NEW.timestamp, 
        updated_at = CURRENT_TIMESTAMP
    WHERE device_id = v_device_id;
END;]]></body>
<triggerTime>AFTER</triggerTime>
<table>95A9FD51-A20B-8EEC-ABF8-1C3E34182FD4</table>
</TriggerOraclev10g>